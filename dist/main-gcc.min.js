(function(){var g,e;e=this.Scrabble||(this.Scrabble={});g=e.Board=function(){function d(c){var b,a,f,l,m;f=c.size;m=c.words;b=c.grid;e.Util.isMatrixQuadratic(b)?f=e.Util.sizeMatrix(b):b=void 0;if(!g.isValidSize(f))throw Error("Grid size not given");b||(b=e.Util.generateGrid(f));l=e.Util.wordList({size:f,words:m});a=new e.Score({grid:b,dictionary:m});this.size=function(){return f};this.isWord=function(a){return e.WordFinder.isWord({word:a,dictionary:l})};this.move=function(f){return a.moveScore(f)};
this.str=function(){return e.Util.printGrid(b)};this.matrix=function(){return e.Util.matrix(b)};this.set=function(a){return e.Util.setCoordinate({coordinates:b,range:f,x:a.x,y:a.y,value:a.value})};this.get=function(a){return e.Util.getCoordinate({coordinates:b,x:a.x,y:a.y})}}d.prototype.inRange=function(c){return e.Util.inRange({value:c,range:this.size()})};return d}();g.isValidSize=function(d){return!d||0>d?!1:!0}}).call(this);
(function(){var g,e,d;e=this.Scrabble||(this.Scrabble={});g={PLAYER:{ONE:{SCORE:"p1score",NAME:"p1name"},TWO:{SCORE:"p2score",NAME:"p2name"}},MESSAGE:"message",GRID:"grid"};d=(e.Game=function(){function c(b){this.words=(null!=b?b:{}).words;if(null==this.words)throw Error("Board or words was not given");}c.prototype["new"]=function(b){var a,f,l,c,h,k=this;a=null!=b?b:{};h=a.size;l=a.player1;c=a.player2;f=a.board;b=a.DOM;a=a.VIEW;this.board=f||new e.Board({size:h||5,words:this.words});this.currentPlayer=
this.player1=l||new e.Player({name:"Player 1"});this.player2=c||new e.Player({name:"Player 2"});this.move=function(a){k.lastMove=$.extend({},{swapCoordinates:a});if(a=k.currentPlayer.move({board:k.board,swapCoordinates:a}))$.extend(k.lastMove,a),k.currentPlayer=k.currentPlayer===k.player1?k.player2:k.player1,k.view.updateGrid();return k.lastMove};a||(a=g);this.view=new d({p1score:a.PLAYER.ONE.SCORE,p2score:a.PLAYER.TWO.SCORE,p1name:a.PLAYER.ONE.NAME,p2name:a.PLAYER.TWO.NAME,grid:a.GRID,context:b,
game:this});this.view.updateScore();this.view.updatePlayerNames();this.view.updateGrid();this.view.watchTiles(function(a){if(null==k.view.selectedTile)return k.view.selectedTile=$.extend({},a);a=e.Util.createSwapCoordinate(k.view.selectedTile.coordinate,a.coordinate);k.move(a);return k.view.selectedTile=void 0});return this};return c}()).View=function(){function c(b){var a,f,l,c,d,k;k=null!=b?b:{};l=k.p1score;d=k.p2score;f=k.p1name;c=k.p2name;b=k.context;a=k.grid;this.game=k.game;this.watcherTiles=
[];this.$p1name=$("#"+f,b);this.$p1score=$("#"+l,b);this.$p2name=$("#"+c,b);this.$p2score=$("#"+d,b);this.$grid=$("#"+a,b)}c.prototype.updateScore=function(){this.$p1score.html(0);return this.$p2score.html(0)};c.prototype.updatePlayerNames=function(){this.$p1name.html(this.game.player1.name());return this.$p2name.html(this.game.player2.name())};c.prototype.updateGrid=function(){var b,a,f,l;this.$grid.empty().append(d.createGrid(this.game.board.matrix()));l=this.watcherTiles;a=0;for(f=l.length;a<f;a++)b=
l[a],this.registerWatchTiles(b);return this.$grid};c.prototype.watchTiles=function(b){this.watcherTiles.push(b);return this.registerWatchTiles(b)};c.prototype.registerWatchTiles=function(b){var a,f;a=this.$grid;f={};return a.find("li").on({catchTileInfo:function(l){var c,h,k;c=d.getCoordinate({grid:a,tile:this});k=e.Util.createSwipeCoordinate(c,l.data||{});h=e.Util.createSwapCoordinate(c,k);$.extend(f,{coordinate:c,el:this,$el:$(this)});null!=l.data&&$.extend(f,{swipeCoordinate:k,swapCoordinate:h});
return b(f)},click:function(){return $(this).trigger("catchTileInfo")},swipeRight:function(){return $(this).trigger("catchTileInfo",{x:1})},swipeLeft:function(){return $(this).trigger("catchTileInfo",{x:-1})},swipeUp:function(){return $(this).trigger("catchTileInfo",{y:-1})},swipeDown:function(){return $(this).trigger("catchTileInfo",{y:1})}})};c.prototype.unwatchTiles=function(){this.watcherTiles=[];return this.$grid.find("li").off()};return c}();d.showMessage=function(c){var b;b=null!=c?c:{};c=
b.message;return $("#"+(b.id||g.MESSAGE),b.context).html(c)};d.createGridLine=function(c){var b,a,f,l;b="";f=0;for(l=c.length;f<l;f++)a=c[f],b+="<li>"+a+"</li>";return $(b)};d.createGrid=function(c){var b,a,f,l,d;b=$("<div>");l=0;for(d=c.length;l<d;l++)a=c[l],f=$("<ul>"),b.append(f.append(this.createGridLine(a)));return b.contents()};d.getCoordinate=function(c){var b,a,f;c=$(c.tile);a=c.parent();b=a.children();f=a.parent().children();return{x:b.index(c),y:f.index(a)}}}).call(this);
(function(){(this.Scrabble||(this.Scrabble={})).Player=function(){return function(g){var e,d,c;d=(null!=g?g:{}).name;g=[0,0];c=g[0];e=g[1];this.name=function(){return d};this.score=function(){return c};this.moveCount=function(){return e};this.move=function(b){var a;a=null!=b?b:{};b=a.board;a=a.swapCoordinates;if(null!=b||null!=a)return b=b.move(a),null!=b&&(e++,c+=b.scoreMove),b}}}()}).call(this);
(function(){var g,e,d,c=[].indexOf||function(b){for(var a=0,f=this.length;a<f;a++)if(a in this&&this[a]===b)return a;return-1};e=this.Scrabble||(this.Scrabble={});d={A:1,B:3,C:3,D:2,E:1,F:4,G:2,H:4,I:1,J:8,K:5,L:1,M:3,N:1,O:1,P:3,Q:10,R:1,S:1,T:1,U:1,V:4,W:4,X:8,Y:4,Z:10};g=e.Score=function(){return function(b){var a,f;f=b.grid;a=b.dictionary;this.printGrid=function(){return e.Util.printGrid(f)};this.matrix=function(){return e.Util.matrix(f)};this.moveScore=function(b){return g.moveScore({grid:f,
dictionary:a,swapCoordinates:b})};this.scoreWord=function(f){return 0<=c.call(a,f)?g.scoreWord(f):0};this.words=function(){return g.words({grid:f,dictionary:a})}}}();g.words=function(b){var a,f,l,d,h,k,g,n,p,r;f=b.grid;b=b.dictionary;a=[[],f.length];d=a[0];a=a[1];for(k=g=0;0<=a?g<a:g>a;k=0<=a?++g:--g)for(l=n=0;0<=a?n<a:n>a;l=0<=a?++n:--n)for(h=e.WordFinder.all({grid:f,dictionary:b,x:k,y:l,range:a}),p=0,r=h.length;p<r;p++)l=h[p],0>c.call(d,l)&&d.push(l);return d};g.move=function(b){var a,f,c,d,h,k;
f=b.grid;k=b.swapCoordinates;b=k.x1;h=k.y1;a=k.x2;k=k.y2;d=e.Util.sizeMatrix(f);c=e.Util.isValidSwapCoordinates({x1:b,y1:h,x2:a,y2:k,range:d});return null!=d&&c?(c=[f[h][b],f[k][a]],f[k][a]=c[0],f[h][b]=c[1],!0):!1};g.moveScore=function(b){var a,f,c;f=b.grid;a=b.dictionary;c=b.swapCoordinates;b=this.words({grid:f,dictionary:a});if(this.move({grid:f,swapCoordinates:c}))return a=this.words({grid:f,dictionary:a}),a=this.newWords({before:b,after:a}),{scoreMove:this.scoreWords(a),newWords:a}};g.scoreWord=
function(b){var a,f,c,m;c=f=0;for(m=b.length;c<m;c++)a=b[c],f+=d[a];return f};g.scoreWords=function(b){var a,f,c,d,h;a=[0,b.length];f=a[0];a=a[1];d=0;for(h=b.length;d<h;d++)c=b[d],f+=this.scoreWord(c);return f*a};g.newWords=function(b){var a,f,d,m,h;f=b.before;a=b.after;h=[];d=0;for(m=a.length;d<m;d++)b=a[d],0>c.call(f,b)&&h.push(b);return h}}).call(this);
(function(){var g,e,d,c,b=[].indexOf||function(a){for(var f=0,b=this.length;f<b;f++)if(f in this&&this[f]===a)return f;return-1};e=(this.Scrabble||(this.Scrabble={})).TileFinder=function(){return function(){}}();g=e.MIN_TILE_LENGTH=2;c=function(a,f){var b,c,d,k;c=a.range;d="";for(b=k=0;0<=c?k<c:k>c;b=0<=c?++k:--k)b=f(b),null!=b&&(d+=b);if(d.length===c)return d};d=function(a,f){var c,d,e,k,q,n;d=a.range;k=[];for(e=q=g;g<=d?q<=d:q>=d;e=g<=d?++q:--q)for(c=n=0;0<=e?n<e:n>e;c=0<=e?++n:--n)c=f(e,c),null==
c||0<=b.call(k,c)||k.push(c);return k};e.verticalOne=function(a){var b,d,e,h;d=a.grid;e=a.range;b=a.x;h=a.y;return c({grid:d,range:e,x:b,y:h},function(a){var c;return null!=(c=d[h+a])?c[b]:void 0})};e.horizontalOne=function(a){var b,d,e,h;d=a.grid;e=a.range;b=a.x;h=a.y;return c({grid:d,range:e,x:b,y:h},function(a){var c;return null!=(c=d[h])?c[b+a]:void 0})};e.diagonalOne_upperLeft_to_lowerRight=function(a){var b,d,e,h;d=a.grid;e=a.range;b=a.x;h=a.y;return c({grid:d,range:e,x:b,y:h},function(a){var c;
return null!=(c=d[h+a])?c[b+a]:void 0})};e.diagonalOne_lowerLeft_to_upperRight=function(a){var b,d,e,h;d=a.grid;e=a.range;b=a.x;h=a.y;return c({grid:d,range:e,x:b,y:h},function(a){var c;return null!=(c=d[h-a])?c[b+a]:void 0})};e.verticalTiles=function(a){var b,c,m,h;b=a.grid;c=a.range;m=a.x;h=a.y;return d({grid:b,range:c,x:m,y:h},function(a,c){return e.verticalOne({grid:b,x:m,y:h-c,range:a})})};e.horizontalTiles=function(a){var b,c,m,h;b=a.grid;c=a.range;m=a.x;h=a.y;return d({grid:b,range:c,x:m,y:h},
function(a,c){return e.horizontalOne({grid:b,x:m-c,y:h,range:a})})};e.diagonalTiles_upperLeft_to_lowerRight=function(a){var b,c,m,h;b=a.grid;c=a.range;m=a.x;h=a.y;return d({grid:b,range:c,x:m,y:h},function(a,c){return e.diagonalOne_upperLeft_to_lowerRight({grid:b,x:m-c,y:h-c,range:a})})};e.diagonalTiles_lowerLeft_to_upperRight=function(a){var b,c,m,h;b=a.grid;c=a.range;m=a.x;h=a.y;return d({grid:b,range:c,x:m,y:h},function(a,c){return e.diagonalOne_lowerLeft_to_upperRight({grid:b,x:m-c,y:h+c,range:a})})};
e.all=function(a){var c,d,e,h,k,g,n,p,r,t,s;d=a.grid;e=a.range;k=a.x;g=a.y;a=[];s=[this.verticalTiles,this.horizontalTiles,this.diagonalTiles_upperLeft_to_lowerRight,this.diagonalTiles_lowerLeft_to_upperRight];n=0;for(r=s.length;n<r;n++)for(c=s[n],h=c({grid:d,range:e,x:k,y:g}),p=0,t=h.length;p<t;p++)c=h[p],0>b.call(a,c)&&a.push(c);return a}}).call(this);
(function(){var g,e,d,c,b,a;g=(this.Scrabble||(this.Scrabble={})).Tile=function(){return function(){}}();b={A:9,B:2,C:2,D:4,E:12,F:2,G:3,H:2,I:9,J:1,K:1,L:4,M:2,N:6,O:8,P:2,Q:1,R:6,S:4,T:6,U:4,V:2,W:2,X:1,Y:2,Z:1};a=0;for(c in b)d=b[c],a+=d;e=function(){var a;a=[];for(c in b)a.push(c);return a}().sort();g.total=function(){return a};g.alphabet=function(){return e.slice(0)};g.randomLetter=function(){var d,l,g,h;d=Math.ceil(Math.random()*a);l=1;g=0;for(h=e.length;g<h;g++)if(c=e[g],l+=b[c],l>d)return c}}).call(this);
(function(){var g,e;g=this.Scrabble||(this.Scrabble={});e=g.Util=function(){return function(){}}();e.isInteger=function(d){return d===Math.round(d)};e.inRange=function(d){var c,b,a;b=d.value;c=d.range;a=d.x;d=d.y;if(null!=b)return this.isInteger(b)&&0<=b&&b<c;if(null!=a&&null!=d)return this.inRange({value:a,range:c})&&this.inRange({value:d,range:c})};e.setCoordinate=function(d){var c,b,a,f;c=d.coordinates;b=d.range;a=d.x;f=d.y;d=d.value;c[a]||(c[a]=[]);this.inRange({value:a,range:b})&&this.inRange({value:f,
range:b})?c[a][f]=d:c[a][f]=void 0;return!!c[a][f]};e.getCoordinate=function(d){return d.coordinates[d.x][d.y]};e.generateGrid=function(d){var c,b;b=[];for(c=0;0<=d?c<d:c>d;0<=d?++c:--c)b.push(function(){var a,b;b=[];for(a=0;0<=d?a<d:a>d;0<=d?++a:--a)b.push(g.Tile.randomLetter());return b}());return b};e.printGrid=function(d){var c;c=this.matrix(d);var b,a,f;f=[];b=0;for(a=c.length;b<a;b++)d=c[b],f.push(" "+d.join(" | "));return f.join("\n")};e.matrix=function(d){var c,b,a,f,e;e=[];c=a=0;for(f=d.length;0<=
f?a<f:a>f;c=0<=f?++a:--a)e.push(function(){var a,f,e;e=[];b=a=0;for(f=d[c].length;0<=f?a<f:a>f;b=0<=f?++a:--a)e.push(d[c][b]);return e}());return e};e.wordList=function(d){var c,b,a,f,e,m;c=d.size;b=d.words;m=[];a=0;for(f=b.length;a<f;a++)d=b[a],g.TileFinder.MIN_TILE_LENGTH<=(e=d.length)&&e<=c&&m.push(d);return m};e.isMatrixQuadratic=function(d){var c,b,a;if(!d)return!1;b=0;for(a=d.length;b<a;b++)if(c=d[b],d.length!==c.length)return!1;return!0};e.sizeMatrix=function(d){if(this.isMatrixQuadratic(d))return d.length};
e.isValidSwapCoordinates=function(d){var c,b,a,f,e,g;a=d.x1;e=d.y1;f=d.x2;g=d.y2;d=d.range;c=Math.abs(f-a);b=Math.abs(g-e);return(c=0<c&&0<b?!1:1===c||1===b)&&null!=d?this.inRange({x:a,y:e,range:d})&&this.inRange({x:f,y:g,range:d}):c};e.createSwapCoordinate=function(d,c){return{x1:d.x,y1:d.y,x2:c.x,y2:c.y}};e.createSwipeCoordinate=function(d,c){var b,a,f,e;b=d.x;f=d.y;a=c.x;e=c.y;null!=a&&(b+=a);null!=e&&(f+=e);return{x:b,y:f}}}).call(this);
(function(){var g,e,d=[].indexOf||function(c){for(var b=0,a=this.length;b<a;b++)if(b in this&&this[b]===c)return b;return-1};g=this.Scrabble||(this.Scrabble={});e=g.WordFinder=function(){return function(){}}();e.isWord=function(c){return 0<=d.call(c.dictionary,c.word)};e.all=function(c){var b,a,d,e,m;a=c.grid;b=c.dictionary;c=g.TileFinder.all({grid:a,dictionary:b,range:c.range,x:c.x,y:c.y});m=[];d=0;for(e=c.length;d<e;d++)a=c[d],this.isWord({word:a,dictionary:b})&&m.push(a);return m}}).call(this);
