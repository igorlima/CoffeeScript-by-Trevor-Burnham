!function(){this.Scrabble=function(){function a(){}return a.defaultView=function(){return{PLAYER:{ONE:{SCORE:"p1score",NAME:"p1name",MSG:"p1message"},TWO:{SCORE:"p2score",NAME:"p2name",MSG:"p2message"}},MESSAGE:"message",NOTICE:"notice",GRID:"grid"}},a}()}.call(this),function(){var a,b,c,d,e,f;a=this.Scrabble.Tile=function(){function a(){}return a}(),e={A:9,B:2,C:2,D:4,E:12,F:2,G:3,H:2,I:9,J:1,K:1,L:4,M:2,N:6,O:8,P:2,Q:1,R:6,S:4,T:6,U:4,V:2,W:2,X:1,Y:2,Z:1},f=0;for(d in e)c=e[d],f+=c;b=function(){var a;a=[];for(d in e)a.push(d);return a}().sort(),a.total=function(){return f},a.alphabet=function(){return b.slice(0)},a.randomLetter=function(){var a,c,g,h;for(a=Math.ceil(Math.random()*f),c=1,g=0,h=b.length;h>g;g++)if(d=b[g],c+=e[d],c>a)return d}}.call(this),function(){var a,b,c,d,e=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};b=this.Scrabble.TileFinder=function(){function a(){}return a}(),a=b.MIN_TILE_LENGTH=2,d=function(a,b){var c,d,e,f,g,h,i,j;for(d=a.grid,g=a.range,c=a.x,h=a.y,i="",e=j=0;g>=0?g>j:j>g;e=g>=0?++j:--j)f=b(e),null!=f&&(i+=f);return i.length===g?i:void 0},c=function(b,c){var d,f,g,h,i,j,k,l,m,n;for(d=b.grid,g=b.range,k=b.x,l=b.y,j=[],i=m=a;g>=a?g>=m:m>=g;i=g>=a?++m:--m)for(f=n=0;i>=0?i>n:n>i;f=i>=0?++n:--n)h=c(i,f),null==h||e.call(j,h)>=0||j.push(h);return j},b.verticalOne=function(a){var b,c,e,f,g;return c=a.grid,f=a.range,b=a.x,g=a.y,e={grid:c,range:f,x:b,y:g},d(e,function(a){var d;return null!=(d=c[g+a])?d[b]:void 0})},b.horizontalOne=function(a){var b,c,e,f,g;return c=a.grid,f=a.range,b=a.x,g=a.y,e={grid:c,range:f,x:b,y:g},d(e,function(a){var d;return null!=(d=c[g])?d[b+a]:void 0})},b.diagonalOne_upperLeft_to_lowerRight=function(a){var b,c,e,f,g;return c=a.grid,f=a.range,b=a.x,g=a.y,e={grid:c,range:f,x:b,y:g},d(e,function(a){var d;return null!=(d=c[g+a])?d[b+a]:void 0})},b.diagonalOne_lowerLeft_to_upperRight=function(a){var b,c,e,f,g;return c=a.grid,f=a.range,b=a.x,g=a.y,e={grid:c,range:f,x:b,y:g},d(e,function(a){var d;return null!=(d=c[g-a])?d[b+a]:void 0})},b.verticalTiles=function(a){var d,e,f,g,h;return d=a.grid,f=a.range,g=a.x,h=a.y,e={grid:d,range:f,x:g,y:h},c(e,function(a,c){return b.verticalOne({grid:d,x:g,y:h-c,range:a})})},b.horizontalTiles=function(a){var d,e,f,g,h;return d=a.grid,f=a.range,g=a.x,h=a.y,e={grid:d,range:f,x:g,y:h},c(e,function(a,c){return b.horizontalOne({grid:d,x:g-c,y:h,range:a})})},b.diagonalTiles_upperLeft_to_lowerRight=function(a){var d,e,f,g,h;return d=a.grid,f=a.range,g=a.x,h=a.y,e={grid:d,range:f,x:g,y:h},c(e,function(a,c){return b.diagonalOne_upperLeft_to_lowerRight({grid:d,x:g-c,y:h-c,range:a})})},b.diagonalTiles_lowerLeft_to_upperRight=function(a){var d,e,f,g,h;return d=a.grid,f=a.range,g=a.x,h=a.y,e={grid:d,range:f,x:g,y:h},c(e,function(a,c){return b.diagonalOne_lowerLeft_to_upperRight({grid:d,x:g-c,y:h+c,range:a})})},b.all=function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o;for(d=a.grid,f=a.range,i=a.x,j=a.y,b=[],o=[this.verticalTiles,this.horizontalTiles,this.diagonalTiles_upperLeft_to_lowerRight,this.diagonalTiles_lowerLeft_to_upperRight],k=0,m=o.length;m>k;k++)for(c=o[k],h=c({grid:d,range:f,x:i,y:j}),l=0,n=h.length;n>l;l++)g=h[l],e.call(b,g)<0&&b.push(g);return b}}.call(this),function(){var a,b,c,d=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};a=this.Scrabble,b=a.TileFinder,c=a.WordFinder=function(){function a(){}return a.isWord=function(a){var b,c;return c=a.word,b=a.dictionary,d.call(b,c)>=0},a.all=function(a){var c,d,e,f,g,h,i,j,k,l;for(e=a.grid,d=a.dictionary,f=a.range,h=a.x,i=a.y,c=b.all({grid:e,dictionary:d,range:f,x:h,y:i}),l=[],j=0,k=c.length;k>j;j++)g=c[j],this.isWord({word:g,dictionary:d})&&l.push(g);return l},a}()}.call(this),function(){var a,b,c,d,e;b=this.Scrabble,c=b.Tile,d=b.TileFinder,e=b.Util=function(){function a(){}return a}(),e.isInteger=function(a){return a===Math.round(a)},e.inRange=function(a){var b,c,d,e;return c=a.value,b=a.range,d=a.x,e=a.y,null!=c?this.isInteger(c)&&c>=0&&b>c:null!=d&&null!=e?this.inRange({value:d,range:b})&&this.inRange({value:e,range:b}):void 0},e.setCoordinate=function(a){var b,c,d,e,f;return b=a.coordinates,c=a.range,e=a.x,f=a.y,d=a.value,b[e]||(b[e]=[]),b[e][f]=this.inRange({value:e,range:c})&&this.inRange({value:f,range:c})?d:void 0,!!b[e][f]},e.getCoordinate=function(a){var b,c,d;return b=a.coordinates,c=a.x,d=a.y,b[c][d]},e.generateGrid=function(a){var b,d,e,f;for(f=[],b=e=0;a>=0?a>e:e>a;b=a>=0?++e:--e)f.push(function(){var b,e;for(e=[],d=b=0;a>=0?a>b:b>a;d=a>=0?++b:--b)e.push(c.randomLetter());return e}());return f},e.printGrid=function(a){var b,c,d;return d=this.matrix(a),c=function(){var a,c,e;for(e=[],a=0,c=d.length;c>a;a++)b=d[a],e.push(" "+b.join(" | "));return e}(),c.join("\n")},e.matrix=function(a){var b,c,d,e,f;for(f=[],b=d=0,e=a.length;e>=0?e>d:d>e;b=e>=0?++d:--d)f.push(function(){var d,e,f;for(f=[],c=d=0,e=a[b].length;e>=0?e>d:d>e;c=e>=0?++d:--d)f.push(a[b][c]);return f}());return f},e.wordList=function(a){var b,c,e,f,g,h,i;for(b=a.size,e=a.words,i=[],f=0,g=e.length;g>f;f++)c=e[f],d.MIN_TILE_LENGTH<=(h=c.length)&&b>=h&&i.push(c);return i},e.isMatrixQuadratic=function(a){var b,c,d;if(!a)return!1;for(c=0,d=a.length;d>c;c++)if(b=a[c],a.length!==b.length)return!1;return!0},e.sizeMatrix=function(a){return this.isMatrixQuadratic(a)?a.length:void 0},e.isValidSwapCoordinates=function(a){var b,c,d,e,f,g,h,i,j;return g=a.x1,i=a.y1,h=a.x2,j=a.y2,f=a.range,d=Math.abs(h-g),e=Math.abs(j-i),b=d>0&&e>0,c=b?!1:1===d||1===e,c&&null!=f?this.inRange({x:g,y:i,range:f})&&this.inRange({x:h,y:j,range:f}):c},e.createSwapCoordinate=function(a,b){var c,d,e,f;return c=a.x,e=a.y,d=b.x,f=b.y,{x1:c,y1:e,x2:d,y2:f}},e.createSwipeCoordinate=function(a,b){var c,d,e,f;return c=a.x,e=a.y,d=b.x,f=b.y,null!=d&&(c+=d),null!=f&&(e+=f),{x:c,y:e}},a=e.Message=function(){function a(){}var b;return b=function(a){var b,c,d;return b=a.player,c=a.score,{name:null!=b?"function"==typeof b.name?b.name():void 0:void 0,numberWords:null!=c?null!=(d=c.newWords)?d.length:void 0:void 0,points:null!=c?c.points:void 0,words:(null!=c?c.newWords:void 0)||[]}},a.points=function(a){var c,d,e,f,g,h,i,j;for(d=a.player,e=a.score,d=b({player:d,score:e}),g="",j=d.words,h=0,i=j.length;i>h;h++)f=j[h],g+="<strong>"+f+"</strong> ";return c=""+d.name+" formed the following "+d.numberWords+" word(s):",c+="<br>"+g+"<br>",c+="Earning <strong>"+d.points+"</strong> points"},a.tile=function(a){var b,c,d,e,f,g;return d=a.tile,b=a.player,c=null!=b?b.name():void 0,null!=d?(g=d.coordinate||{},e=g.x,f=g.y,""+c+" selected tile ("+e+", "+f+"). Please select a second tile."):""+c+", please select a tile."},a}()}.call(this),function(){var a;a=this.Scrabble.Player=function(){function a(a){var b,c,d,e,f;c=(null!=a?a:{}).name,f=[0,0,[]],d=f[0],b=f[1],e=f[2],this.name=function(){return c},this.score=function(){return d},this.moveCount=function(){return b},this.words=function(){var a,b,c,d;for(d=[],b=0,c=e.length;c>b;b++)a=e[b],d.push(a);return d},this.move=function(a){var c,f,g,h;return h=null!=a?a:{},c=h.board,g=h.swapCoordinates,null!=c||null!=g?(f=c.move(g),null!=f&&(b++,d+=f.points,e.push.apply(e,f.newWords),e.sort()),f):void 0}}return a}()}.call(this),function(){var a,b,c,d,e,f=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};b=this.Scrabble,c=b.Util,e=b.WordFinder,d={A:1,B:3,C:3,D:2,E:1,F:4,G:2,H:4,I:1,J:8,K:5,L:1,M:3,N:1,O:1,P:3,Q:10,R:1,S:1,T:1,U:1,V:4,W:4,X:8,Y:4,Z:10},a=b.Score=function(){function b(b){var d,e;e=b.grid,d=b.dictionary,this.printGrid=function(){return c.printGrid(e)},this.matrix=function(){return c.matrix(e)},this.moveScore=function(b){return a.moveScore({grid:e,dictionary:d,swapCoordinates:b})},this.scoreWord=function(b){return f.call(d,b)>=0?a.scoreWord(b):0},this.words=function(){return a.words({grid:e,dictionary:d})}}return b}(),a.words=function(a){var b,c,d,g,h,i,j,k,l,m,n,o,p;for(d=a.grid,c=a.dictionary,p=[[],d.length],h=p[0],b=p[1],j=l=0;b>=0?b>l:l>b;j=b>=0?++l:--l)for(k=m=0;b>=0?b>m:m>b;k=b>=0?++m:--m)for(i=e.all({grid:d,dictionary:c,x:j,y:k,range:b}),n=0,o=i.length;o>n;n++)g=i[n],f.call(h,g)<0&&h.push(g);return h},a.move=function(a){var b,d,e,f,g,h,i,j,k;return e=a.grid,j=a.swapCoordinates,b=j.x1,h=j.y1,d=j.x2,i=j.y2,g=c.sizeMatrix(e),f=c.isValidSwapCoordinates({x1:b,y1:h,x2:d,y2:i,range:g}),null!=g&&f?(k=[e[h][b],e[i][d]],e[i][d]=k[0],e[h][b]=k[1],!0):!1},a.moveScore=function(a){var b,c,d,e,f,g;return c=a.grid,b=a.dictionary,e=a.swapCoordinates,g=this.words({grid:c,dictionary:b}),this.move({grid:c,swapCoordinates:e})?(f=this.words({grid:c,dictionary:b}),d=this.newWords({before:g,after:f}),{points:this.scoreWords(d),newWords:d}):void 0},a.scoreWord=function(a){var b,c,e,f;for(c=0,e=0,f=a.length;f>e;e++)b=a[e],c+=d[b];return c},a.scoreWords=function(a){var b,c,d,e,f,g;for(g=[0,a.length],c=g[0],b=g[1],e=0,f=a.length;f>e;e++)d=a[e],c+=this.scoreWord(d);return c*b},a.newWords=function(a){var b,c,d,e,g,h;for(d=a.before,c=a.after,h=[],e=0,g=c.length;g>e;e++)b=c[e],f.call(d,b)<0&&h.push(b);return h}}.call(this),function(){var a,b,c,d,e;c=this.Scrabble,d=c.Util,b=c.Score,e=c.WordFinder,a=c.Board=function(){function c(c){var f,g,h,i;if(g=c.size,i=c.words,f=c.grid,d.isMatrixQuadratic(f)?g=d.sizeMatrix(f):f=void 0,!a.isValidSize(g))throw new Error("Grid size not given");f||(f=d.generateGrid(g)),h=d.wordList({size:g,words:i}),this.score=new b({grid:f,dictionary:h}),this.size=function(){return g},this.isWord=function(a){return e.isWord({word:a,dictionary:h})},this.move=function(a){return this.score.moveScore(a)},this.str=function(){return d.printGrid(f)},this.matrix=function(){return d.matrix(f)},this.set=function(a){var b,c,e;return c=a.x,e=a.y,b=a.value,d.setCoordinate({coordinates:f,range:g,x:c,y:e,value:b})},this.get=function(a){var b,c;return b=a.x,c=a.y,d.getCoordinate({coordinates:f,x:b,y:c})}}return c.prototype.inRange=function(a){return d.inRange({value:a,range:this.size()})},c}(),a.isValidSize=function(a){return!a||0>a?!1:!0}}.call(this),function(){var a,b,c,d,e,f,g;e=this.Scrabble,a=e.Board,d=e.Player,f=e.Util,g=e.defaultView,b=g(),c=e.Game=function(){function e(a){if(this.words=(null!=a?a:{}).words,null==this.words)throw new Error("Board or words was not given")}var g;return e.prototype["new"]=function(c){var e,f,g,h,i,j,k=this;return j=null!=c?c:{},i=j.size,g=j.player1,h=j.player2,f=j.board,this.DOM=j.DOM,e=j.VIEW,this.board=f||new a({size:i||5,words:this.words}),this.currentPlayer=this.player1=g||new d({name:"Player 1"}),this.player2=h||new d({name:"Player 2"}),this.VIEW=e||b,this.move=function(a){var b;return k.lastMove=$.extend({},{swapCoordinates:a}),b=k.currentPlayer.move({board:k.board,swapCoordinates:a}),k.message(b),b&&(k.notice(b),$.extend(k.lastMove,b),k.currentPlayer=k.currentPlayer===k.player1?k.player2:k.player1,k.view.update()),k.lastMove},this.initView(),this},g=function(a){var b,c,d;null==this.view.selectedTile?(this.view.selectedTile=$.extend({},a),this.view.selectedTile.$el.addClass("selected"),this.message(!1)):(b=this.view.selectedTile.coordinate,c=a.coordinate,d=f.createSwapCoordinate(b,c),this.move(d),this.view.selectedTile.$el.removeClass("selected"),this.view.selectedTile=void 0,this.message(this.lastMove.points))},e.prototype.initView=function(a){var b,d=this;b=(null!=a?a:{}).watchTiles,this.view=new c.View({ELEMENTS:this.VIEW,context:this.DOM,game:this}),this.view.updatePlayerNames(),this.view.update(),this.message(!1),this.view.watchTiles(function(a){return null!=b?b(a):g.call(d,a)})},e.prototype.message=function(a){var d,e,g,h;g=this.currentPlayer,d=b.MESSAGE,h=this.view.selectedTile,e=f.Message.tile({tile:h,player:g}),null==a&&(e="Invalid move. "+e),c.View.showMessage({message:e,context:this.DOM,id:d})},e.prototype.notice=function(a){var d,e,g;null!=a&&(g=this.currentPlayer,d=b.NOTICE,e=f.Message.points({player:g,score:a}),c.View.showMessage({message:e,context:this.DOM,id:d}))},e}()}.call(this),function(){var a,b,c,d,e,f;c=this.Scrabble,d=c.Util,b=c.Game,f=c.defaultView,a=f(),e=b.View=function(){function a(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;d=null!=a?a:{},b=d.ELEMENTS,c=d.context,this.game=d.game,this.watcherTiles=[],this.$p1name=$("#"+(null!=b?null!=(e=b.PLAYER)?null!=(i=e.ONE)?i.NAME:void 0:void 0:void 0),c),this.$p1score=$("#"+(null!=b?null!=(j=b.PLAYER)?null!=(k=j.ONE)?k.SCORE:void 0:void 0:void 0),c),this.$p1message=$("#"+(null!=b?null!=(l=b.PLAYER)?null!=(m=l.ONE)?m.MSG:void 0:void 0:void 0),c),this.$p2name=$("#"+(null!=b?null!=(n=b.PLAYER)?null!=(o=n.TWO)?o.NAME:void 0:void 0:void 0),c),this.$p2score=$("#"+(null!=b?null!=(p=b.PLAYER)?null!=(f=p.TWO)?f.SCORE:void 0:void 0:void 0),c),this.$p2message=$("#"+(null!=b?null!=(g=b.PLAYER)?null!=(h=g.TWO)?h.MSG:void 0:void 0:void 0),c),this.$grid=$("#"+(null!=b?b.GRID:void 0),c)}return a.prototype.updateScore=function(){var a,b,c,d,e,f;a=null!=(c=this.game)?null!=(d=c.player1)?d.score():void 0:void 0,b=null!=(e=this.game)?null!=(f=e.player2)?f.score():void 0:void 0,this.$p1score.html(a),this.$p2score.html(b)},a.prototype.updatePlayerNames=function(){this.$p1name.html(this.game.player1.name()),this.$p2name.html(this.game.player2.name())},a.prototype.updatePlayerWords=function(){var a,b,c,d,e,f,g,h,i;for(b=a="",h=this.game.player1.words(),d=0,f=h.length;f>d;d++)c=h[d],a+=""+c+" ";for(i=this.game.player2.words(),e=0,g=i.length;g>e;e++)c=i[e],b+=""+c+" ";this.$p1message.html(""+a),this.$p2message.html(""+b)},a.prototype.updateGrid=function(){var a,b,c,d;for(this.$grid.empty().append(e.createGrid(this.game.board.matrix())),d=this.watcherTiles,b=0,c=d.length;c>b;b++)a=d[b],this.registerWatchTiles(a)},a.prototype.update=function(){this.updateScore(),this.updatePlayerWords(),this.updateGrid()},a.prototype.watchTiles=function(a){this.watcherTiles.push(a),this.registerWatchTiles(a)},a.prototype.registerWatchTiles=function(a){var b,c;b=this.$grid,c={},b.find("li").on({catchTileInfo:function(f){var g,h,i;return g=e.getCoordinate({grid:b,tile:this}),i=d.createSwipeCoordinate(g,f.data||{}),h=d.createSwapCoordinate(g,i),$.extend(c,{coordinate:g,el:this,$el:$(this)}),null!=f.data&&$.extend(c,{swipeCoordinate:i,swapCoordinate:h}),a(c)},click:function(){return $(this).trigger("catchTileInfo")},swipeRight:function(){return $(this).trigger("catchTileInfo",{x:1})},swipeLeft:function(){return $(this).trigger("catchTileInfo",{x:-1})},swipeUp:function(){return $(this).trigger("catchTileInfo",{y:-1})},swipeDown:function(){return $(this).trigger("catchTileInfo",{y:1})}})},a.prototype.unwatchTiles=function(){this.watcherTiles=[],this.$grid.find("li").off()},a}(),e.showMessage=function(a){var b,c,d,e,f;f=null!=a?a:{},e=f.message,c=f.context,d=f.id,b=$("#"+d,c),b.html(e)},e.createGridLine=function(a){var b,c,d,e;for(b="",d=0,e=a.length;e>d;d++)c=a[d],b+="<li>"+c+"</li>";return $(b)},e.createGrid=function(a){var b,c,d,e,f;for(b=$("<div>"),e=0,f=a.length;f>e;e++)c=a[e],d=$("<ul>"),b.append(d.append(this.createGridLine(c)));return b.contents()},e.getCoordinate=function(a){var b,c,d,e,f,g;return f=a.grid,g=a.tile,b=$(g),d=b.parent(),c=d.children(),e=d.parent().children(),{x:c.index(b),y:e.index(d)}}}.call(this);